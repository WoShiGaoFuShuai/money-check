import{g as be}from"./getDayLabel-d438a4ed.js";import{d as U,r as B,o as y,c as D,g as n,F as fe,i as ve,t as v,a as g,f as q,_ as Y,j as I,e as me,W as ye,k as V,A as De,l as L,m as F,v as k,E as de,b as O,M as ne,h as K,p as xe,n as Ie,q as Ae,J as ge,w as we}from"./index-d34b31e1.js";import{b as Ce,T as Ee}from"./accounts-17264377.js";const $e={class:"transfer__window-wrapper","data-testid":"transfer__window-wrapper"},Re=["onClick"],Se={class:"transfer__item-info"},Fe={key:0,class:"transfer__item-choosen",role:"transfer__item-choosen"},ke=U({__name:"TransferWindow",props:{transferAccounts:{type:Array,required:!0},choosenAccountIndex:{type:Number,required:!0}},emits:["chooseAccount"],setup(a,{emit:c}){const e=a,r=o=>{c("chooseAccount",o)};return(o,i)=>{const l=B("font-awesome-icon");return y(),D("div",$e,[n("ul",null,[(y(!0),D(fe,null,ve(e.transferAccounts,(p,b)=>(y(),D("li",{key:b,class:"transfer__item",role:"transfer__item",onClick:x=>r(b)},[n("div",Se,[n("div",null,v(p.title),1),n("div",null,[n("span",null,v(p.sum),1),n("span",null,v(p.currency),1)])]),a.choosenAccountIndex===b?(y(),D("div",Fe,[g(l,{icon:"fa-solid fa-check"})])):q("",!0)],8,Re))),128))])])}}});const Oe=Y(ke,[["__scopeId","data-v-f2ee298c"]]),We={class:"transfer-select__wrapper"},Ne={role:"title"},qe={class:"transfer-select__info"},Ve={role:"acc-title"},Me={role:"acc-sum"},Ue={role:"acc-currency"},Be=U({__name:"TransferAccount",props:{title:{type:String,required:!0},accounts:{type:Array,required:!0},choosenAccountIndex:{type:Number,required:!0}},emits:["chooseDebitAccount","chooseCreditAccount"],setup(a,{emit:c}){const e=a,r=I(!1),o=()=>{r.value=!r.value},i=l=>{e.title.includes("Debit")?c("chooseDebitAccount",l):e.title.includes("Credit")&&c("chooseCreditAccount",l),r.value=!1};return(l,p)=>{const b=B("font-awesome-icon");return y(),D(fe,null,[n("div",We,[n("h4",Ne,v(e.title),1),n("div",{class:"transfer-select__block","data-testid":"transfer-select-block",onClick:o},[n("div",qe,[n("span",Ve,v(e.accounts[e.choosenAccountIndex].title),1),n("div",null,[n("span",Me,v(e.accounts[e.choosenAccountIndex].sum),1),n("span",Ue,v(e.accounts[e.choosenAccountIndex].currency),1)])]),n("div",null,[g(b,{icon:"fa-solid fa-chevron-right"})])])]),r.value?(y(),me(Oe,{key:0,"transfer-accounts":e.accounts,"choosen-account-index":e.choosenAccountIndex,onChooseAccount:i},null,8,["transfer-accounts","choosen-account-index"])):q("",!0)],64)}}});const le=Y(Be,[["__scopeId","data-v-e039181a"]]),_e=ye("transfers",{state:()=>({transfers:[{amount:5,creditTitle:"acc5",debitTitle:"acc1",note:"check",timestamp:Date.now(),createdTime:Date.now(),currency:"Rp"},{timestamp:Date.now(),note:"different",debitAmount:1,creditAmount:10,debitTitle:"acc1",creditTitle:"acc3",createdTime:Date.now(),currencyDebit:"Rp",currencyCredit:"€"},{amount:2,creditTitle:"acc3",debitTitle:"acc4",note:"haha",timestamp:Date.now()-1*30*24*60*60*1e3,createdTime:Date.now()-1*30*24*60*60*1e3,currency:"Y"},{amount:3,creditTitle:"acc5",debitTitle:"acc6",note:"haha",timestamp:Date.now()-2*30*24*60*60*1e3,createdTime:Date.now()-2*30*24*60*60*1e3,currency:"Y"},{amount:4,creditTitle:"acc3",debitTitle:"acc4",note:"haha",timestamp:Date.now()-4*30*24*60*60*1e3,createdTime:Date.now()-4*30*24*60*60*1e3,currency:"Y"}],editTransfer:[]}),actions:{addToTransfers(a){this.transfers.push(a)},addToEditTransfer(a){this.editTransfer.length&&(this.editTransfer=[]),this.editTransfer.push(a)},deleteTransfer(a){console.log("deleteTransfer in transfer store",a),this.transfers.splice(a,1)},clearEditTransfer(){this.editTransfer=[]}},getters:{transfersTodaySorted(a){const c=Date.now(),e=new Date(c);return e.setHours(0,0,0,0),a.transfers.filter(o=>o.timestamp>=e.getTime()).sort((o,i)=>i.createdTime-o.createdTime)},transfersYesterdaySorted(a){const c=Date.now(),e=new Date(c),r=new Date(c-864e5);return e.setHours(0,0,0,0),r.setHours(0,0,0,0),a.transfers.filter(i=>i.timestamp>=r.getTime()&&i.timestamp<e.getTime()).sort((i,l)=>l.createdTime-i.createdTime)},allMonths(a){const c=new Set;return a.transfers.forEach(e=>{const r=new Date(e.timestamp),o=r.toLocaleString("en",{month:"long"}),i=r.getFullYear();c.add(`${o} ${i}`)}),Array.from(c)},sortedTransfers(a){return a.transfers.sort((c,e)=>e.timestamp-c.timestamp)}}});var $=(a=>(a.EDITMODE="editMode",a.DEFAULT="default",a))($||{});const Ye=["onSubmit"],je={class:"transfer__form-input__wrapper"},Le=["max"],He={class:"transfer__form-input__wrapper input__wrapper--bottom"},ze={key:2,class:"transfer__form-btn",role:"submitButton",type:"submit"},Je={key:0,class:"deleteTransaction__wrapper"},Ge={key:1,style:{color:"red"}},Ke=U({__name:"TransferForm",props:{isSameCurrency:{type:Boolean,required:!0},infoInputData:{type:Object,required:!0},mode:{type:String,required:!0},isShowError:{type:Boolean,required:!1}},emits:["submitTransfer","showExchangeRate","sendTrasnferInfoFormDifferentCurrency","valueInputForm","valueNoteForm","valueDateForm","deleteTransaction"],setup(a,{emit:c}){const e=a,r=V(()=>{const s=new Date,f=s.getFullYear();let m=s.getMonth()+1,T=s.getDate();return m<10&&(m=`0${m}`),T<10&&(T=`0${T}`),`${f}-${m}-${T}`}),o=I(null),i=V(()=>e.infoInputData.isShowTextInput?`${e.infoInputData.debitAmount} ${e.infoInputData.debitCurrency} → ${e.infoInputData.creditAmount} ${e.infoInputData.creditCurrency}`:""),l=I(""),p=I(""),b=()=>{if(e.isSameCurrency){const m={timestamp:new Date(p.value).getTime(),note:l.value,amount:o.value,createdTime:Date.now()};c("submitTransfer",o.value,m)}else{const f=new Date(p.value).getTime(),m=i,T="→",M=m.value.indexOf(T),W=m.value.slice(0,M-1).trim(),R=m.value.slice(M+2).trim(),H=" ",z=W.indexOf(H),J=R.indexOf(H),P=+W.slice(0,z),Q=W.slice(z+1),X=+R.slice(0,J),Z=R.slice(J+1),G={timestamp:f,note:l.value,createdTime:Date.now(),debitAmount:P,debitCurrency:Q,creditAmount:X,creditCurrency:Z};c("sendTrasnferInfoFormDifferentCurrency",G)}o.value=null,l.value=""},x=()=>{if(e.isSameCurrency)return;const f=new Date(p.value).getTime();l.value,Date.now(),c("showExchangeRate")},w=()=>{c("deleteTransaction")},h=_e();return De(()=>{const s=h.editTransfer.length>=1?h.editTransfer[0].timestamp:Date.now(),f=new Date(s),m=f.getFullYear(),T=String(f.getMonth()+1).padStart(2,"0"),M=String(f.getDate()).padStart(2,"0"),W=`${m}-${T}-${M}`;if(p.value=W,e.mode===$.EDITMODE){const R=h.editTransfer[0];l.value=h.editTransfer[0].note,"amount"in R&&(o.value=`${R.amount}`)}}),L(o,s=>{e.mode===$.EDITMODE&&s!==null&&c("valueInputForm",+s)}),L(l,s=>{e.mode===$.EDITMODE&&c("valueNoteForm",s)}),L(p,s=>{e.mode===$.EDITMODE&&c("valueDateForm",s)}),(s,f)=>{const m=B("font-awesome-icon");return y(),D("form",{class:"transfer__form",onSubmit:ne(b,["prevent"])},[n("div",je,[F(n("input",{id:"date","onUpdate:modelValue":f[0]||(f[0]=T=>p.value=T),class:"transfer__form-input",type:"date",name:"date",required:"",role:"dateInput",max:r.value},null,8,Le),[[k,p.value]]),F(n("input",{id:"note","onUpdate:modelValue":f[1]||(f[1]=T=>l.value=T),class:"transfer__form-input",type:"text",name:"note",placeholder:"Note"},null,512),[[k,l.value]])]),n("div",He,[e.isSameCurrency?F((y(),D("input",{key:0,id:"amount","onUpdate:modelValue":f[2]||(f[2]=T=>o.value=T),class:de(["transfer__form-input","transfer__form-input--last",{"mr-0":e.mode===O($).EDITMODE}]),type:"number",name:"amount",placeholder:"Amount",required:"",role:"amountInput",onFocus:x},null,34)),[[k,o.value]]):F((y(),D("input",{key:1,id:"amountDifferentCurrency","onUpdate:modelValue":f[3]||(f[3]=T=>i.value=T),class:de(["transfer__form-input","transfer__form-input--last",{"mr-0":e.mode===O($).EDITMODE}]),type:"text",name:"amount",placeholder:"Amount",required:"",role:"amountDifferentCurrency",readonly:"",onFocus:x},null,34)),[[k,i.value]]),e.mode!==O($).EDITMODE?(y(),D("button",ze,[g(m,{icon:"fa-solid fa-check"})])):q("",!0)]),e.mode===O($).EDITMODE?(y(),D("div",Je,[g(m,{icon:"fa-solid fa-trash",class:"btn__primary-form deleteTransaction__btn",onClick:w})])):q("",!0),a.isShowError?(y(),D("p",Ge," Amount should be more than 0 ")):q("",!0)],40,Ye)}}});const Pe=Y(Ke,[["__scopeId","data-v-730564c7"]]),Qe={class:"recent__item-left"},Xe={"data-testId":"transfer__debit",class:"recent__item-title"},Ze={"data-testId":"transfer__credit",class:"recent__item-title"},et={"data-testId":"transfer__dayLabel"},tt={key:0,"data-testId":"transfer__note"},nt={class:"recent__item-right"},rt={"data-testId":"transfer__amount",class:"recent__item-amount"},ot=U({__name:"TransferTransactionItem",props:{transfer:{type:Object,required:!0}},emits:["transactionItemClick"],setup(a,{emit:c}){const e=a,r=i=>"amount"in i?`${i.amount} ${i.currency}`:`${i.debitAmount} ${i.currencyDebit}  (${i.creditAmount} ${i.currencyCredit})`,o=i=>{c("transactionItemClick",i)};return(i,l)=>{const p=B("font-awesome-icon");return y(),D("div",{class:"recent__item","data-testId":"transfer__item",onClick:l[0]||(l[0]=b=>o(e.transfer))},[n("div",Qe,[n("div",null,[n("span",Xe,v(e.transfer.debitTitle),1),g(p,{icon:"fa-solid fa-arrow-right-long",class:"recent__item-icon"}),n("span",Ze,v(e.transfer.creditTitle),1)]),n("div",et,v(O(be)(e.transfer.timestamp)),1),e.transfer.note!==""?(y(),D("p",tt,v(e.transfer.note),1)):q("",!0)]),n("div",nt,[n("span",rt,v(r(a.transfer)),1)])])}}});const St=Y(ot,[["__scopeId","data-v-eb008f8b"]]),at=a=>(xe("data-v-b1d9bbb0"),a=a(),Ie(),a),ct=["onSubmit"],st={class:"exchangeRate__top-wrapper"},it={class:"exchangeRate__top-item"},ut={class:"exchangeRate__currency",for:"first"},dt={class:"exchangeRate__top-item"},lt={class:"exchangeRate__currency",for:"second"},ft={class:"exchangeRate__bottom-wrapper"},mt=at(()=>n("p",{class:"exchangeRate__bottom-title"},"Exchange rate",-1)),_t={class:"exchangeRate__bottom-item"},pt={for:"exchange__first",class:"exchangeRate__currency-left"},ht={class:"exchangeRate__currency-right"},Tt={class:"exchangeRate__bottom-item"},bt={for:"exchange__second",class:"exchangeRate__currency-left"},vt={class:"exchangeRate__currency-right"},yt={class:"exchangeRate__btns"},Dt={type:"submit",class:"exchangeRate__btns-item btn__primary-form",role:"submitButton"},xt=U({__name:"TransferExchangeRate",props:{debitAccount:{type:Object,required:!0},creditAccount:{type:Object,required:!0}},emits:["closeTransferExchangeRate","submitTransferWithDifferentCurrency"],setup(a,{emit:c}){const e=a,r=I(null),o=I(null),i=I(null),l=I(null),p=V(()=>{if(r.value!==null&&r.value>0&&o.value!==null&&o.value>0){const h=(o.value/r.value).toFixed(7);return Number(h)}return null}),b=V(()=>{if(r.value!==null&&r.value>0&&o.value!==null&&o.value>0){const h=(r.value/o.value).toFixed(7);return Number(h)}return null}),x=()=>{const h={debitAmount:r.value,creditAmount:o.value,debitCurrency:e.debitAccount.currency,creditCurrency:e.creditAccount.currency};c("submitTransferWithDifferentCurrency",h),c("closeTransferExchangeRate")};L(p,h=>{i.value=h}),L(b,h=>{l.value=h});const w=()=>{c("closeTransferExchangeRate")};return(h,s)=>{const f=B("font-awesome-icon");return y(),D("div",{class:"exchangeRate__wrapper",onClick:w},[n("form",{class:"exchangeRate__form",onClick:s[4]||(s[4]=ne(()=>{},["stop"])),onSubmit:ne(x,["prevent"])},[n("div",st,[n("div",it,[n("label",ut,v(e.debitAccount.currency),1),F(n("input",{id:"first","onUpdate:modelValue":s[0]||(s[0]=m=>r.value=m),type:"number",class:"exchangeRate__top-item__input",placeholder:"transfer amount",required:"",role:"debitInput"},null,512),[[k,r.value]])]),n("div",dt,[n("label",lt,v(e.creditAccount.currency),1),F(n("input",{id:"second","onUpdate:modelValue":s[1]||(s[1]=m=>o.value=m),type:"number",class:"exchangeRate__top-item__input",placeholder:"will be credited",required:"",role:"creditInput"},null,512),[[k,o.value]])])]),n("div",ft,[mt,n("div",_t,[n("label",pt,[K("1 "),n("span",null,v(e.debitAccount.currency),1),K(" =")]),F(n("input",{id:"exchange__first","onUpdate:modelValue":s[2]||(s[2]=m=>i.value=m),type:"text",class:"exchangeRate__bottom-item__input",role:"firstExchangeRateInput"},null,512),[[k,i.value]]),n("span",ht,v(e.creditAccount.currency),1)]),n("div",Tt,[n("label",bt,[K("1 "),n("span",null,v(e.creditAccount.currency),1),K(" =")]),F(n("input",{id:"exchange__second","onUpdate:modelValue":s[3]||(s[3]=m=>l.value=m),type:"text",class:"exchangeRate__bottom-item__input",role:"secondExchangeRateInput"},null,512),[[k,l.value]]),n("span",vt,v(e.debitAccount.currency),1)])]),n("div",yt,[n("button",{type:"button",class:"exchangeRate__btns-item btn__primary-form",role:"closeButton",onClick:w},[g(f,{icon:"fa-solid fa-xmark"})]),n("button",Dt,[g(f,{icon:"fa-solid fa-check"})])])],40,ct)])}}});const It=Y(xt,[["__scopeId","data-v-b1d9bbb0"]]),At={class:"editTransferWindow__wrapper"},gt={class:"editTransfer"},wt=U({__name:"EditTransferWindow",props:{editDebitAccountIndex:{type:Number,required:!0},editCreditAccountIndex:{type:Number,required:!0},infoInputData:{type:Object,required:!0}},emits:["closeEditTransferWindow","changeEditChoosenDebitAccountIndex","changeEditChoosenCreditAccountIndex","resetInfoInputData","submitTransferWithDifferentCurrency"],setup(a,{emit:c}){const e=a,r=Ce(),o=_e(),i=()=>{c("closeEditTransferWindow")},l=V(()=>r.accounts[e.editDebitAccountIndex].currency===r.accounts[e.editCreditAccountIndex].currency),p=V(()=>r.accounts[e.editDebitAccountIndex]),b=V(()=>r.accounts[e.editCreditAccountIndex]),x=Ae({timestamp:0,note:"",createdTime:0,debitTitle:"",creditTitle:"",currencyCredit:"",currencyDebit:""}),w=I(0),h=I(""),s=I(""),f=I(!1),m=t=>{x.timestamp=t.timestamp,x.note=t.note,x.createdTime=t.createdTime,x.debitTitle=p.value.title,x.creditTitle=b.value.title,x.currencyDebit=p.value.currency,x.currencyCredit=b.value.currency},T=I(!1),M=()=>{T.value=!0},W=()=>{T.value=!1},R=t=>{c("submitTransferWithDifferentCurrency",t)},H=t=>{c("changeEditChoosenDebitAccountIndex",t)},z=t=>{c("changeEditChoosenCreditAccountIndex",t)},J=t=>{w.value=t},P=t=>{h.value=t},Q=t=>{s.value=t},X=()=>{var C;if(w.value<=0&&!((C=e.infoInputData)!=null&&C.isShowTextInput)){f.value=!0;return}const t=G(),u=re(t),{indexEditDebitAcc:d,indexEditCreditAcc:_,editCreditAcc:E,editDebitAcc:A}=ae(t);if(u){const N=oe(u);if(o.deleteTransfer(N),"amount"in u&&u.amount!==null&&l.value&&d!==null&&_!==null){ee(d,_,u.amount),ce(e.editDebitAccountIndex,e.editCreditAccountIndex,w.value);const S=ie(s.value,h.value,w.value,p.value.title,b.value.title,b.value.currency);o.addToTransfers(S),f.value=!1,j();return}else if("amount"in u&&u.amount!==null&&!l.value&&d!==null&&_!==null){if(ee(d,_,u.amount),e.infoInputData.debitAmount!==null&&e.infoInputData.creditAmount!==null){const S=ue(s.value,e.editDebitAccountIndex,e.editCreditAccountIndex,e.infoInputData.debitAmount,e.infoInputData.debitCurrency,e.infoInputData.creditAmount,e.infoInputData.creditCurrency,h.value);o.addToTransfers(S),se(e.editDebitAccountIndex,e.editCreditAccountIndex,e.infoInputData.debitAmount,e.infoInputData.creditAmount)}j();return}else if("debitAmount"in t&&t.debitAmount!==null&&t.creditAmount!==null&&!l.value){if(E&&A&&d!==null&&_!==null&&te(d,t.debitAmount,_,t.creditAmount),e.infoInputData.debitAmount!==null&&e.infoInputData.creditAmount!==null){const S=ue(s.value,e.editDebitAccountIndex,e.editCreditAccountIndex,e.infoInputData.debitAmount,e.infoInputData.debitCurrency,e.infoInputData.creditAmount,e.infoInputData.creditCurrency,h.value);o.addToTransfers(S),se(e.editDebitAccountIndex,e.editCreditAccountIndex,e.infoInputData.debitAmount,e.infoInputData.creditAmount)}j();return}else if("debitAmount"in t&&t.debitAmount!==null&&t.creditAmount!==null&&l.value){E&&A&&d!==null&&_!==null&&te(d,t.debitAmount,_,t.creditAmount),ce(e.editDebitAccountIndex,e.editCreditAccountIndex,w.value);const S=ie(s.value,h.value,w.value,p.value.title,b.value.title,b.value.currency);o.addToTransfers(S),f.value=!1,j();return}}},Z=()=>{const t=G(),u=re(t),{indexEditDebitAcc:d,indexEditCreditAcc:_,editCreditAcc:E,editDebitAcc:A}=ae(t);if(u){const C=oe(u);o.deleteTransfer(C),"amount"in u&&u.amount!==null&&d!==null&&_!==null?ee(d,_,u.amount):"debitAmount"in t&&t.debitAmount!==null&&t.creditAmount!==null&&E&&A&&d!==null&&_!==null&&te(d,t.debitAmount,_,t.creditAmount),j()}};ge(()=>{o.clearEditTransfer()});function G(){return o.editTransfer[0]}function re(t){return o.transfers.find(u=>u===t)}function ee(t,u,d){r.undoTransfer(t,u,d)}function te(t,u,d,_){r.undoTransferWithDifferentCurrency(t,u,d,_)}function oe(t){return o.transfers.indexOf(t)}function ae(t){let u=null,d=null;const _=t.creditTitle,E=t.debitTitle,A=r.accounts.find(N=>N.title===_),C=r.accounts.find(N=>N.title===E);return A&&C&&(u=r.accounts.indexOf(C),d=r.accounts.indexOf(A)),{indexEditDebitAcc:u,indexEditCreditAcc:d,editCreditAcc:A,editDebitAcc:C}}function ce(t,u,d){r.transfer(t,u,d)}function se(t,u,d,_){r.transferWithDifferentCurrency(t,u,d,_)}function ie(t,u,d,_,E,A){return{timestamp:new Date(t).getTime(),note:u,amount:d,debitTitle:_,creditTitle:E,createdTime:Date.now(),currency:A}}function j(){c("resetInfoInputData"),c("closeEditTransferWindow")}function ue(t,u,d,_,E,A,C,N){const pe=new Date(t).getTime(),he=r.accounts[u].title,Te=r.accounts[d].title;return{createdTime:Date.now(),debitAmount:_,currencyDebit:E,creditAmount:A,currencyCredit:C,timestamp:pe,note:N,creditTitle:Te,debitTitle:he}}return(t,u)=>{const d=B("font-awesome-icon");return y(),D("div",At,[g(Ee,{"right-icons":[{icon:"fa-solid fa-check",handler:X}],title:"Editing"},{"left-icons":we(()=>[g(d,{icon:"fa-solid fa-xmark",onClick:i})]),_:1},8,["right-icons"]),n("div",gt,[g(le,{title:"Debit the account",accounts:O(r).accounts,"choosen-account-index":e.editDebitAccountIndex,onChooseDebitAccount:H},null,8,["accounts","choosen-account-index"]),g(le,{title:"Credit the account",accounts:O(r).accounts,"choosen-account-index":e.editCreditAccountIndex,onChooseCreditAccount:z},null,8,["accounts","choosen-account-index"]),g(Pe,{ref:"transferFormRef",mode:O($).EDITMODE,"is-same-currency":l.value,"info-input-data":a.infoInputData,"is-show-error":f.value,onShowExchangeRate:M,onSendTrasnferInfoFormDifferentCurrency:m,onValueInputForm:J,onValueNoteForm:P,onValueDateForm:Q,onDeleteTransaction:Z},null,8,["mode","is-same-currency","info-input-data","is-show-error"]),T.value?(y(),me(It,{key:0,"debit-account":p.value,"credit-account":b.value,onCloseTransferExchangeRate:W,onSubmitTransferWithDifferentCurrency:R},null,8,["debit-account","credit-account"])):q("",!0)])])}}});const Ft=Y(wt,[["__scopeId","data-v-0df68120"]]);export{Ft as E,St as T,le as a,Pe as b,It as c,$ as m,_e as u};
